<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>BangBet | Highest odds betting site</title>
    <link rel="stylesheet" type="text/css" href="./icon/iconfont.css" />
    <style>
        a{
            text-decoration: none
        }
        .top{
            height: 0.8rem;
            display: flex;
            align-items: center;
        }
        .title{
            margin-top: 0.62rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .title-txt{
            margin-left: 0.15rem;
            font-size: 0.36rem;
            font-family: Roboto-Bold, Roboto;
            font-weight: bold;
            color: #32333D;
        }
        .img{
            margin-top: 0.61rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .img img{
            width: 5.2rem;
            height: auto;
        }
        .deposit{
            margin: 0.46rem auto 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 6.4rem;
            height: 0.96rem;
            background: #10A310;
            border-radius: 0.08rem;
            font-size: 0.3rem;
            font-family: Roboto-Bold, Roboto;
            font-weight: bold;
            color: #FFFFFF;
        }
        .back-to-home{
            display: block;
            text-align: center;
            margin-top: 1.25rem;
            font-size: 0.28rem;
            font-family: Roboto-Regular, Roboto;
            font-weight: 400;
            color: #517AB8;
        }
        .count-down{
            margin-top: 0.12rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .count-down-txt{
            display: flex;
            align-items: center;
            font-size: 0.3rem;
            font-family: Roboto-Regular, Roboto;
            font-weight: 400;
            color: #32333D;
        }
        .success-icon{
            color: #10A310;
            font-size: 0.45rem;
        }
        .close-icon{
            font-size: 0.36rem;
            color: #C0C7CF;
        }
        .down-time{
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgb( 50,51,61);
            margin-left: 0.2rem;
            width: 0.48rem;
            height: 0.48rem;
            background: rgba(255,230,15,0.5);
            border-radius: 0.04rem;
            font-size: 0.26rem;
        }
        .keep-dialog{
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
        }
        .keep-dialog-cover {
            width: 90%;
            background: #FFFFFF;
            border-radius: 0.1rem;
            box-sizing: border-box;
            padding: 0.6rem 0.48rem 0.4rem;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        .pay-dialog-item{
            display: flex;
            height: 0.6rem;
            align-items: center;
        }
        .pay-dialog-item-name{
            font-size: 0.24rem;
            font-family: Roboto-Regular, Roboto;
            font-weight: 400;
            color: #393A46;
        }
        .pay-dialog-item-value{
            margin-left: 1.8rem;
            font-size: 0.24rem;
            font-family: Roboto-Bold, Roboto;
            font-weight: bold;
            color: #393A46;
        }
        .pay-dialog-item-copy{
            display: flex;
            justify-content: center;
            align-items: center;
            margin-left: auto;
            width: 1.03rem;
            height: 0.4rem;
            background: #F2F3F5;
            border-radius: 0.04rem;
            border: 0.02rem solid #F2F3F5;
            font-size: 0.24rem;
            font-family: Roboto-Regular, Roboto;
            font-weight: 400;
            color: #10A310;
        }
        .completed-button{
            display: flex;
            margin-top: 0.4rem;
            justify-content: center;
            align-items: center;
            height: 0.88rem;
            background: #10A310;
            border-radius: 0.08rem;
            font-size: 0.32rem;
            font-family: ArialMT;
            color: #FFFFFF;
        }
        .pay-close-icon{
            position: absolute;
            top: 0.2rem;
            right: 0.24rem;
            color:#F2F3F5;
        }
        .ug-fail-txt{
            font-size: 0.24rem;
            font-family: Roboto-Regular, Roboto;
            font-weight: 400;
            color: #393A46;
        }
        .dialog-content{
            position: relative;
            width: 6.26rem;
            background-color: #fff;
            display: flex;
            align-items: center;
            flex-direction: column;
            text-align: center;
            box-sizing: border-box;
            border-radius: 0.1rem;
        }
        .success-tit {
            position:absolute;
            top:-20%;
            width:100%;
        }
        .success-tit img{
            width: 100%;
            display: flex;
        }
        .amount-dialog{
            position:fixed;
            top:0;
            right:0;
            bottom:0;
            left:0;
            background-color:rgba(0,0,0,0.5);
            display:flex;
            justify-content:center;
            align-items:center;
            z-index:666;
            display: none;
        }
        .dialog-content .success-cont{
            margin-top:1rem;
            font-size:0.3rem;
        }
        .dialog-content .deposit-success{
            margin-top:0.16rem;
            margin-bottom:0.2rem;
            color:#35B435;
            font-size:0.42rem;
            font-weight:bold;
            font-style:italic
        }
        .btn-group{
            font-size:0.24rem;
            width:1.68rem;
            height:0.76rem;
            margin-top:0.4rem;
            display:flex;
            justify-content:center;
            align-items:center;
            background-color:#449444;
            color:#fff;
        }
        .deposit-remind{
            color:#8F8F8F;
            font-size:0.24rem;
            margin-top:0.2rem;
            margin-bottom:0.7rem;
        }
    </style>
</head>
<body>
<div>
    <div class="top">
        <i class="icon iconfont iconIcon_Close_ close-icon" id="join-success-close"></i>
    </div>
    <div class="title">
        <i class="icon iconfont iconIcon_Success_128 success-icon"></i>
       <span class="title-txt"> Join Successfully</span>
    </div>
    <div class="img">
        <img id="join-successfully-ad">
    </div>
    <div class="count-down">
        <div class="count-down-txt" id="count-down-deposit">
            Deal ends in
            <div class="down-time" id="down-time-minute"></div>
            <div class="down-time" id="down-time-second"></div>
        </div>
    </div>
    <div class="deposit" id="deposit-button"></div>
    <a class="back-to-home" href="https://www.bangbet.com/">Back to home></a>
    <!--    肯尼亚充值失败弹窗-->
    <div class="keep-dialog" id="pay-fail-dialog">
        <div class="keep-dialog-cover">
            <i class="icon iconfont iconIcon_Close_ pay-close-icon" id="close-pay-item"></i>
            <div class="pay-dialog-item">
                <div class="pay-dialog-item-name">M-Pesa Paybill</div>
                <div class="pay-dialog-item-value">999880</div>
                <div class="pay-dialog-item-copy">Copy</div>
            </div>
            <div class="pay-dialog-item">
                <div class="pay-dialog-item-name">Airtel Paybill</div>
                <div class="pay-dialog-item-value">BANGBET</div>
                <div class="pay-dialog-item-copy">Copy</div>
            </div>
            <div class="completed-button" id="completed-button-payment" onclick="closePayItemDomFn()">
                I've completed the payment
            </div>
        </div>
    </div>

    <!--    乌干达充值失败弹窗-->
    <div class="keep-dialog" id="ug-pay-fail-dialog">
        <div class="keep-dialog-cover">
           <div class="ug-fail-txt" id="ug-fail-txt"></div>
            <div class="completed-button" id="ug-completed-button-payment">
               ok
            </div>
        </div>
    </div>

    <!--    肯尼亚充值成功的弹窗-->
    <div class="amount-dialog" id="amount-dialog">
        <div class="dialog-content">
            <div class="success-tit">
                <img src="./images/people-success.png" alt="" class="tit-img">
            </div>
            <!--自定义内容-->
            <div class="content success-cont">
                <p class="deposit-money">
                    <span>49KSH</span>
                    <!--额外金额-->
                    extra was
                </p >
                <p class="deposit-success">successfully deposited!</p >
            </div>
            <!--按钮组-->
            <div class="btn-group" id="btn-group-success">
                <div class="btn-confirm" >OK</div>
            </div>
            <p class="deposit-remind">Please check your account balance</p >
        </div>
    </div>

</div>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<script src="js/sigin.js"></script>
<script src="js/request.js"></script>
<script src="js/index.js"></script>
<script>
    const API_CONFIG ={
        base:'https://bet-api.gbank.team/api',
        game:'https://casino-api.gbank.team/api',
        href:'https://www.gbank.team'
    };
    //获取国家信息
    function getCountry(){
        //获取缓存中的国家数值
        let countryCode =  window.localStorage.getItem('country');
        if(countryCode == 2){
            return 'ng';
        }else if(countryCode == 1){
            return 'ug';
        }else {
            return 'ke';
        }
    };
    //获取userInfo信息
    function getUserInfo(){
        let userInfo = window.localStorage['user'];
        return JSON.parse(userInfo);
    };
    //肯尼亚充值
    function  mpesa(){
        let userInfo = getUserInfo();
        let token = userInfo.token;
        let secretKey = userInfo.secretKey;
        let signParameters = new Sign({token:token,secretKey:secretKey});
        let singObj = signParameters.sign('POSTJSON',{amount:49,platform:3});
        ajax("POST",singObj, API_CONFIG.game + '/payments/mpesa/onlinePay', JSON.stringify({
            amount: 49,
            platform: 3
        }), 30000, function (res){
            if (res.result == 1) {
                //充值成功
                let amountDialogDom = document.getElementById('amount-dialog');
                amountDialogDom.style.display = 'flex';
            }else {
                //充值失败
                let payFailDialogDom = document.getElementById('pay-fail-dialog');
                payFailDialogDom.style.display = 'block';
            }
        });
    };
    //乌干达充值
    function payments(){
        let userInfo = getUserInfo();
        let token = userInfo.token;
        let secretKey = userInfo.secretKey;
        let signParameters = new Sign({token:token,secretKey:secretKey});
        let singObj = signParameters.sign('POSTJSON',{amount:1000,platform:3});
        ajax("POST",singObj,  API_CONFIG.game + '/payments/yo/deposit', JSON.stringify({
            amount: 1000,
            platform: 3
        }), 30000, function (res){
            if (res.result == 1) {
                //充值成功
                window.location.href = API_CONFIG.href;
            }else {
                //充值失败
                let ugFailTxtDom = document.getElementById('ug-fail-txt');
                ugFailTxtDom.textContent = res.info;
                let ugPayDailDialogDom = document.getElementById('ug-pay-fail-dialog');
                ugPayDailDialogDom.style.display = 'block';
                let ugCompletedButtonPaymentDom = document.getElementById('ug-completed-button-payment');
                ugCompletedButtonPaymentDom.addEventListener('click',function (){
                    ugPayDailDialogDom.style.display = 'none';
                })
            }
        });
    };

    function closePayItemDomFn(){
        let payFailDialogDom = document.getElementById('pay-fail-dialog');
        payFailDialogDom.style.display = 'none';
    };
    window.onload = function (){
        let downTimeMinuteDom = document.getElementById('down-time-minute');
        let downTimeSecondDom = document.getElementById('down-time-second');
        let depositButtonDom = document.getElementById('deposit-button');
        let countDownDepositDom = document.getElementById('count-down-deposit');
        let payFailDialogDom = document.getElementById('pay-fail-dialog');
        let closePayItemDom = document.getElementById('close-pay-item');
        let completedButtonPaymentDom = document.getElementById('completed-button-payment');
        let btnGroupSuccessDom = document.getElementById('btn-group-success');
        btnGroupSuccessDom.addEventListener('click',function (){
            window.location.href = API_CONFIG.href;
        })
        closePayItemDom.addEventListener('click',function (){
            payFailDialogDom.style.display = 'none';
        });
        if(getCountry() == 'ke'){
            depositButtonDom.textContent = 'DEPOSIT 49 TO GET';
            depositButtonDom.addEventListener('click',function (){
                mpesa();
            });
        }else if(getCountry() == 'ng'){
            depositButtonDom.textContent = 'DEPOSIT 100 TO GET';
            depositButtonDom.addEventListener('click',function (){
                window.location.href = API_CONFIG.href + "/user/ng-deposit?defmoney=1000&jumptype=empty";
            });
        }
        else {
            depositButtonDom.textContent = 'DEPOSIT 1000 TO GET';
            depositButtonDom.addEventListener('click',function (){
                payments();
            });
        }
        //获取配置文件
        httpAjax("POST", 'JSON', API_CONFIG.base + '/bet/message/list', JSON.stringify({
            country: getCountry(),
            type: "register"
        }), 30000, function (res){
            if(res && res.result == 1){
                console.log(  res.data.messages,' res.data.messages.RegisterUndertakeAd');
                let registerUndertakeAdLsit = res.data.messages.RegisterUndertakeAd.split('&&');
                let joinSuccessfullyAdDom = document.getElementById('join-successfully-ad');
                joinSuccessfullyAdDom.src = registerUndertakeAdLsit[1];
                let downTime = registerUndertakeAdLsit[0];
                let downTime_copy = registerUndertakeAdLsit[0];
                let downsetInterval = setInterval(function (){
                    let minuteTime = Math.floor(downTime/60) % 60;
                    downTimeMinuteDom.innerText = minuteTime.toString().length == 2 ? minuteTime+'\'':'0'+minuteTime+'\'';
                    let secondTime = downTime % 60;
                    downTimeSecondDom.innerText = secondTime.toString().length == 1 ?  '0'+secondTime+'\'\'':secondTime+'\'\'';
                    downTime--;
                    if(downTime == 0){
                        downTime =  downTime_copy
                        // clearInterval(downsetInterval);
                    }
                },1000)
            }
        });
        let joinSuccessCloseDom = document.getElementById('join-success-close');
        joinSuccessCloseDom.addEventListener('click',function (){
            window.location.href = API_CONFIG.href;
        })
    }
</script>
</body>
</html>